/* Base Theme Variables */
/* Refined color system (inspired by modern dashboard palettes) */
:root {
  --bg: #f8f9fb; /* page background */
  --bg-alt: #ffffff; /* surface cards */
  --bg-soft: #eef2f7; /* subtle blocks */
  --text: #202632;
  --text-muted: #5b6575;
  --border: #d9e1eb;
  --accent: #2563eb; /* primary indigo/blue */
  --accent-rgb: 37,99,235;
  --accent-soft: rgba(var(--accent-rgb), .08);
  --danger: #e44747;
  --warning: #f59e0b;
  --success: #16a34a;
  --info: #0ea5e9;
  --radius: 10px;
  --shadow-sm: 0 1px 2px rgba(0,0,0,.06),0 1px 3px rgba(0,0,0,.08);
  --shadow-md: 0 4px 12px rgba(0,0,0,.08);
  --gradient-accent: linear-gradient(135deg, #2563eb, #4f46e5);
}

[data-theme="dark"] {
  --bg: #05070c;
  --bg-alt: #0f1520;
  --bg-soft: #16202c;
  --text: #f5f7fb;
  --text-muted: #98a5b8;
  --border: #243140;
  --accent: #5b8dff;
  --accent-rgb: 91,141,255;
  --accent-soft: rgba(var(--accent-rgb), .18);
  --danger: #ff7171;
  --warning: #ffbe49;
  --success: #3ddc91;
  --info: #4fc3ff;
  --shadow-sm: 0 2px 4px rgba(0,0,0,.55),0 3px 8px rgba(0,0,0,.45);
  --shadow-md: 0 6px 20px rgba(0,0,0,.55);
  --gradient-accent: linear-gradient(135deg, #3058ff, #8b5cf6);
}

/* Theming overrides to ensure dark mode consistent */
[data-theme="dark"] .nav-tabs .nav-link { color: var(--text-muted); }
[data-theme="dark"] .nav-tabs .nav-link.active { background: var(--accent-soft); color: var(--accent); }
[data-theme="dark"] .accordion-button { background: var(--bg-alt); color: var(--text); }
[data-theme="dark"] .accordion-button:not(.collapsed) { color: var(--accent); }
[data-theme="dark"] .list-group-item { background: var(--bg-alt); color: var(--text); border-color: var(--border); }
[data-theme="dark"] .modal-content { background: var(--bg-alt); }
[data-theme="dark"] .form-control, [data-theme="dark"] .form-select { background: var(--bg-soft); color: var(--text); }
[data-theme="dark"] .calendar-grid .day { background: var(--bg-alt); }

body.bg-body { background: var(--bg); color: var(--text); font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif; position:relative; }
body.bg-body::before { content:""; position:fixed; inset:0; z-index:-3; background:radial-gradient(circle at 15% 20%, rgba(var(--accent-rgb), .25), transparent 60%), radial-gradient(circle at 85% 70%, rgba(255,180,0,.18), transparent 55%); mix-blend-mode:screen; pointer-events:none; }
body.bg-body::after { content:""; position:fixed; inset:0; z-index:-4; background:linear-gradient(120deg, var(--bg) 0%, var(--bg-soft) 45%, var(--bg) 100%); animation: bgShift 14s ease-in-out infinite alternate; background-size:200% 200%; opacity:.85; }
@keyframes bgShift { from { background-position:0% 50%; } to { background-position:100% 50%; } }
/* Subtle noise overlay */
.noise-layer { position:fixed; inset:0; z-index:-2; pointer-events:none; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.15'/%3E%3C/svg%3E"); mix-blend-mode:overlay; }
.bg-alt { background: var(--bg-alt); }
.text-body { color: var(--text); }
.border-theme { border-color: var(--border) !important; }

.card { background: linear-gradient(145deg, var(--bg-alt), var(--bg-soft)); border: 1px solid rgba(255,255,255,.04); border-radius: var(--radius); box-shadow: var(--shadow-sm); transition: background .35s, box-shadow .25s, transform .25s; backdrop-filter: blur(4px); }
.card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
.navbar { background: var(--gradient-accent); box-shadow: var(--shadow-md); }
.nav-tabs .nav-link { border: none; color: var(--text-muted); font-weight: 500; }
.nav-tabs .nav-link.active { background: var(--accent-soft); color: var(--accent); border-radius: var(--radius); }
.nav-link:hover { color: var(--accent); }

button, .btn { border-radius: calc(var(--radius) - 4px) !important; }
.btn-primary, .btn-success, .btn-outline-primary:hover { box-shadow: var(--shadow-sm); }
.btn-primary, .btn-success, .btn-accent-gradient {
  position:relative;
  background:var(--gradient-accent) !important;
  border:none !important;
  color:#fff !important;
  font-weight:600;
  letter-spacing:.4px;
  overflow:hidden;
}
.btn-primary::before, .btn-success::before, .btn-accent-gradient::before {
  content:""; position:absolute; inset:0; background:linear-gradient(90deg, rgba(255,255,255,.15), rgba(255,255,255,0), rgba(255,255,255,.15)); opacity:0; transition:opacity .4s; }
.btn-primary:hover::before, .btn-success:hover::before, .btn-accent-gradient:hover::before { opacity:1; }
.btn-outline-light, .btn-outline-secondary, .btn-outline-danger { position:relative; overflow:hidden; }
.btn-outline-light:hover, .btn-outline-secondary:hover, .btn-outline-danger:hover { box-shadow:0 0 0 2px var(--accent-soft); }
.glow-hover { position:relative; }
.glow-hover::after { content:""; position:absolute; inset:-2px; border-radius:inherit; background:radial-gradient(circle at 50% 50%, rgba(var(--accent-rgb),.55), transparent 70%); opacity:0; transition:opacity .35s; filter:blur(8px); z-index:-1; }
.glow-hover:hover::after { opacity:.9; }

.form-control, .form-select { background: var(--bg-alt); border:1px solid var(--border); border-radius: calc(var(--radius) - 4px); }
.form-control:focus, .form-select:focus { border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-soft); }

.app-section { animation: fade .2s ease-in; }
@keyframes fade { from { opacity:0 } to { opacity:1 } }

.calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; }
.calendar-grid .day { border:1px solid var(--border); min-height:92px; padding:4px; position:relative; border-radius:var(--radius); background:var(--bg-alt); font-size:.72rem; box-shadow: var(--shadow-sm); }
.calendar-grid .day:hover { border-color: var(--accent); }
.calendar-grid .day .date { font-weight:600; font-size:.7rem; opacity:.7; }
.calendar-item { display:block; padding:3px 6px; margin:3px 0; border-radius:6px; font-size:.62rem; font-weight:500; line-height:1.1; color:#fff; cursor:pointer; text-decoration:none; letter-spacing:.3px; box-shadow: 0 1px 2px rgba(0,0,0,.2); }
.calendar-item.rating { background:rgba(var(--accent-rgb), .9); }
.calendar-item.topic { background:var(--info); }
.calendar-item.fourweek { background:var(--warning); color:#172130; }
.calendar-item.upsolve-contest { background: var(--danger); }
.calendar-item.upsolve-problem { background: var(--accent); }

.badge-solved { background: var(--success); }
.badge-unsolved { background: var(--danger); }
.badge-pending { background: var(--warning); color:#172130; }

.accordion-button { background: var(--bg-alt); color: var(--text); font-weight:500; }
.accordion-button:not(.collapsed) { color: var(--accent); box-shadow: inset 0 -1px 0 var(--border); }
.accordion-item { background: linear-gradient(145deg, var(--bg-alt), var(--bg-soft)); border:1px solid rgba(255,255,255,.05); border-radius: var(--radius); overflow:hidden; }

.list-group-item { background: linear-gradient(155deg, var(--bg-alt), var(--bg-soft)); color: var(--text); border:1px solid rgba(255,255,255,.05); margin-bottom:6px; border-radius: var(--radius); }
#progressDonut { width:100%; max-width:170px; filter:drop-shadow(0 4px 10px rgba(var(--accent-rgb), .35)); }
[data-theme="dark"] .btn-primary, [data-theme="dark"] .btn-success { color:#fff; }
[data-theme="dark"] .btn-outline-light { border-color: var(--accent); color: var(--accent); }
[data-theme="dark"] .btn-outline-light:hover { background: var(--accent); color:#fff; }
.list-group-item:last-child { margin-bottom:0; }

.modal-content { background: var(--bg-alt); border:1px solid var(--border); box-shadow: var(--shadow-md); border-radius: var(--radius); }
.modal-header { border-bottom:1px solid var(--border); }
.modal-footer { border-top:1px solid var(--border); }

.search-highlight { background: var(--accent-soft); padding:2px 4px; border-radius:4px; color: var(--accent); }

.placeholder-empty { opacity:.65; font-style:italic; }

/* Skeleton loading */
.skeleton { position:relative; overflow:hidden; background: var(--bg-soft); border-radius:6px; }
.skeleton::after { content:''; position:absolute; inset:0; background:linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent); animation: shimmer 1.2s infinite; }
@keyframes shimmer { from { transform:translateX(-100%);} to { transform:translateX(100%);} }

.skeleton-line { height:12px; margin:6px 0; }
.skeleton-line.wide { width:90%; }
.skeleton-line.mid { width:60%; }
.skeleton-line.small { width:35%; }

/* Progress donut responsive width */
#progressDonut { width:100%; max-width:170px; }

/* Responsive tweaks */
@media (max-width: 768px) {
  .calendar-grid .day { min-height:70px; }
  #progressDonut { width:100% !important; }
  .nav-tabs { flex-wrap:wrap; }
  .d-flex > .form-select.form-select-sm { width:100% !important; }
  #nextMonthTabs + .tab-content .d-flex { flex-direction:column; align-items:stretch !important; gap:.5rem; }
  .navbar .form-control { width:140px; }
}
