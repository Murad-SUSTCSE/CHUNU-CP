/* Single Dark Blue Theme (no light mode) */
:root {
  --bg: #060d17;
  --bg-alt: #102235;
  --bg-soft: #173145;
  --text: #ffffff;
  --text-muted: #9fbbd3;
  --border: #1f3448;
  --accent: #4f8dff;
  --accent-rgb: 79,141,255;
  --accent-soft: rgba(var(--accent-rgb), .22);
  --danger: #ff6b6b;
  --warning: #ffb74d;
  --success: #31d691;
  --info: #46c5ff;
  --radius: 16px;
  --shadow-sm: 0 2px 4px rgba(0,0,0,.5), 0 6px 14px -4px rgba(0,0,0,.55);
  --shadow-md: 0 14px 38px -6px rgba(0,0,0,.65);
  --gradient-accent: linear-gradient(135deg, #3d6dff, #7a4dff);
}

body.bg-body { background: var(--bg); color: var(--text); font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif; position:relative; }
body.bg-body::before { content:""; position:fixed; inset:0; z-index:-3; background:radial-gradient(circle at 15% 20%, rgba(var(--accent-rgb), .25), transparent 60%), radial-gradient(circle at 85% 70%, rgba(255,180,0,.18), transparent 55%); mix-blend-mode:screen; pointer-events:none; }
body.bg-body::after { content:""; position:fixed; inset:0; z-index:-4; background:linear-gradient(120deg, var(--bg) 0%, var(--bg-soft) 45%, var(--bg) 100%); animation: bgShift 14s ease-in-out infinite alternate; background-size:200% 200%; opacity:.85; }
@keyframes bgShift { from { background-position:0% 50%; } to { background-position:100% 50%; } }
/* Subtle noise overlay */
.noise-layer { position:fixed; inset:0; z-index:-2; pointer-events:none; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.15'/%3E%3C/svg%3E"); mix-blend-mode:overlay; }
/* FX Canvas */
#bgFxCanvas { position:fixed; inset:0; width:100%; height:100%; z-index:-5; pointer-events:none; }
.bg-alt { background: var(--bg-alt); }
.text-body { color: var(--text); }
.border-theme { border-color: var(--border) !important; }

.card { background: linear-gradient(145deg, var(--bg-alt), var(--bg-soft)); border: 1px solid rgba(255,255,255,.04); border-radius: var(--radius); box-shadow: var(--shadow-sm); transition: background .35s, box-shadow .25s, transform .25s; backdrop-filter: blur(4px); }
.card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
.card::before { content:""; position:absolute; inset:0; border-radius:inherit; padding:1px; background:linear-gradient(140deg, rgba(var(--accent-rgb),.55), rgba(var(--accent-rgb),0) 60%); -webkit-mask:linear-gradient(#000,#000) content-box, linear-gradient(#000,#000); mask:linear-gradient(#000,#000) content-box, linear-gradient(#000,#000); -webkit-mask-composite:xor; mask-composite:exclude; opacity:0; transition:opacity .4s; pointer-events:none; }
.card:hover::before { opacity:.9; }
.navbar { background: var(--gradient-accent); box-shadow: var(--shadow-md); }
.nav-tabs .nav-link { border: none; color: var(--text-muted); font-weight: 500; }
.nav-tabs .nav-link.active { background: var(--accent-soft); color: var(--accent); border-radius: var(--radius); }
.nav-link:hover { color: var(--accent); }

button, .btn { border-radius: calc(var(--radius) - 4px) !important; }
.btn-primary, .btn-success, .btn-outline-primary:hover { box-shadow: var(--shadow-sm); }
.btn-primary, .btn-success, .btn-accent-gradient {
  position:relative;
  background:var(--gradient-accent) !important;
  border:none !important;
  color:#fff !important;
  font-weight:600;
  letter-spacing:.4px;
  overflow:hidden;
}
.btn-primary::before, .btn-success::before, .btn-accent-gradient::before {
  content:""; position:absolute; inset:0; background:linear-gradient(90deg, rgba(255,255,255,.15), rgba(255,255,255,0), rgba(255,255,255,.15)); opacity:0; transition:opacity .4s; }
.btn-primary:hover::before, .btn-success:hover::before, .btn-accent-gradient:hover::before { opacity:1; }
.btn-outline-light, .btn-outline-secondary, .btn-outline-danger { position:relative; overflow:hidden; }
.btn-outline-light:hover, .btn-outline-secondary:hover, .btn-outline-danger:hover { box-shadow:0 0 0 2px var(--accent-soft); }
.glow-hover { position:relative; }
.glow-hover::after { content:""; position:absolute; inset:-2px; border-radius:inherit; background:radial-gradient(circle at 50% 50%, rgba(var(--accent-rgb),.55), transparent 70%); opacity:0; transition:opacity .35s; filter:blur(8px); z-index:-1; }
.glow-hover:hover::after { opacity:.9; }

.form-control, .form-select { background: var(--bg-alt); border:1px solid var(--border); border-radius: calc(var(--radius) - 4px); }
.form-control:focus, .form-select:focus { border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-soft); }

.app-section { animation: fade .2s ease-in; }
@keyframes fade { from { opacity:0 } to { opacity:1 } }

.calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; }
.calendar-grid .day { border:1px solid var(--border); min-height:92px; padding:4px; position:relative; border-radius:var(--radius); background:var(--bg-alt); font-size:.72rem; box-shadow: var(--shadow-sm); }
.calendar-grid .day:hover { border-color: var(--accent); }
.calendar-grid .day .date { font-weight:600; font-size:.7rem; opacity:.7; }
.calendar-item { display:block; padding:3px 6px; margin:3px 0; border-radius:6px; font-size:.62rem; font-weight:500; line-height:1.1; color:#fff; cursor:pointer; text-decoration:none; letter-spacing:.3px; box-shadow: 0 1px 2px rgba(0,0,0,.2); }
.calendar-item.rating { background:rgba(var(--accent-rgb), .9); }
.calendar-item.topic { background:var(--info); }
.calendar-item.fourweek { background:var(--warning); color:#172130; }
.calendar-item.upsolve-contest { background: var(--danger); }
.calendar-item.upsolve-problem { background: var(--accent); }

.badge-solved { background: var(--success); }
.badge-unsolved { background: var(--danger); }
.badge-pending { background: var(--warning); color:#172130; }

.accordion-button { background: var(--bg-alt); color: var(--text); font-weight:500; }
.accordion-button:not(.collapsed) { color: var(--accent); box-shadow: inset 0 -1px 0 var(--border); }
.accordion-item { background: linear-gradient(145deg, var(--bg-alt), var(--bg-soft)); border:1px solid rgba(255,255,255,.05); border-radius: var(--radius); overflow:hidden; }

.list-group-item { background: linear-gradient(155deg, var(--bg-alt), var(--bg-soft)); color: var(--text); border:1px solid rgba(255,255,255,.05); margin-bottom:6px; border-radius: var(--radius); }
#progressDonut { width:100%; max-width:170px; filter:drop-shadow(0 4px 10px rgba(var(--accent-rgb), .35)); }
/* Bento dashboard layout */
.dashboard-bento { display:grid; gap:18px; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); align-items:stretch; }
.dashboard-bento .card { height:100%; }
.dashboard-bento .card[data-wide='true'] { grid-column: span 2; }
.dashboard-bento .card[data-tall='true'] { grid-row: span 2; }
@media (min-width:1400px){ .dashboard-bento { grid-template-columns: repeat(6, 1fr); } }
@media (max-width:600px){ .dashboard-bento { grid-template-columns: repeat(auto-fit, minmax(160px,1fr)); gap:12px; } }
/* Theme-specific button overrides removed (single theme) */

/* Reveal Animations */
.reveal { opacity:0; transform:translateY(18px) scale(.98); transition:opacity .8s ease, transform .8s cubic-bezier(.22,.61,.36,1); will-change:transform,opacity; }
.reveal.visible { opacity:1; transform:translateY(0) scale(1); }
.reveal[data-reveal-delay='1'] { transition-delay:.05s; }
.reveal[data-reveal-delay='2'] { transition-delay:.1s; }
.reveal[data-reveal-delay='3'] { transition-delay:.15s; }
.reveal[data-reveal-delay='4'] { transition-delay:.2s; }

/* Floating orb accents (optional utility) */
.floating-orb { position:absolute; width:240px; height:240px; border-radius:50%; background:radial-gradient(circle at 35% 35%, rgba(var(--accent-rgb),.55), rgba(var(--accent-rgb),0) 70%); filter:blur(40px) saturate(140%); opacity:.28; animation: orbDrift 26s linear infinite; mix-blend-mode:screen; pointer-events:none; }
.floating-orb.orb-alt { background:radial-gradient(circle at 65% 65%, rgba(255,180,0,.4), rgba(var(--accent-rgb),0) 70%); animation-duration:34s; animation-direction:reverse; }
@keyframes orbDrift { 0% { transform:translate3d(-10%, -5%,0) scale(1);} 50% { transform:translate3d(25%,15%,0) scale(1.15);} 100% { transform:translate3d(-10%, -5%,0) scale(1);} }

@media (prefers-reduced-motion: reduce) {
  body.bg-body::after { animation:none; }
  .floating-orb { animation:none; }
  .reveal { transition:none; opacity:1 !important; transform:none !important; }
}
.list-group-item:last-child { margin-bottom:0; }

.modal-content { background: var(--bg-alt); border:1px solid var(--border); box-shadow: var(--shadow-md); border-radius: var(--radius); }
.modal-header { border-bottom:1px solid var(--border); }
.modal-footer { border-top:1px solid var(--border); }

.search-highlight { background: var(--accent-soft); padding:2px 4px; border-radius:4px; color: var(--accent); }

.placeholder-empty { opacity:.65; font-style:italic; }

/* Skeleton loading */
.skeleton { position:relative; overflow:hidden; background: var(--bg-soft); border-radius:6px; }
.skeleton::after { content:''; position:absolute; inset:0; background:linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent); animation: shimmer 1.2s infinite; }
@keyframes shimmer { from { transform:translateX(-100%);} to { transform:translateX(100%);} }

.skeleton-line { height:12px; margin:6px 0; }
.skeleton-line.wide { width:90%; }
.skeleton-line.mid { width:60%; }
.skeleton-line.small { width:35%; }

/* Progress donut responsive width */
#progressDonut { width:100%; max-width:170px; }

/* Responsive tweaks */
@media (max-width: 768px) {
  .calendar-grid .day { min-height:70px; }
  #progressDonut { width:100% !important; }
  .nav-tabs { flex-wrap:wrap; }
  .d-flex > .form-select.form-select-sm { width:100% !important; }
  #nextMonthTabs + .tab-content .d-flex { flex-direction:column; align-items:stretch !important; gap:.5rem; }
  .navbar .form-control { width:140px; }
}

/* New Header & Side Menu (appended) */
.app-header {display:flex;justify-content:space-between;align-items:flex-end;padding:1.8rem 2.2rem 1rem;position:relative;z-index:30;background:linear-gradient(to bottom, rgba(7,17,29,.9), rgba(7,17,29,.55), rgba(7,17,29,0));backdrop-filter:blur(8px);}
.brand-block {max-width:60%;}
.cf-handle {margin:0;font-size:clamp(2.8rem,6vw,4.8rem);line-height:.9;font-weight:800;letter-spacing:-2px;background:linear-gradient(95deg,#ffffff,#e3f4ff,#9edfff 60%,#53bfff 85%);-webkit-background-clip:text;background-clip:text;color:transparent;filter:drop-shadow(0 6px 28px rgba(79,141,255,.45));}
.subtitle {margin:.6rem 0 0;font-size:.85rem;letter-spacing:4px;text-transform:uppercase;font-weight:600;color:var(--text-muted);opacity:.9;}
.header-actions {display:flex;align-items:center;gap:1rem;}
.header-actions input[type=search]{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.15);color:var(--text);padding:.55rem .85rem;font-size:.85rem;border-radius:10px;width:220px;box-shadow:0 2px 8px -2px rgba(0,0,0,.5) inset,0 0 0 1px rgba(255,255,255,.06);}
.header-actions input[type=search]:focus{outline:2px solid var(--accent);}

.side-menu {position:fixed;top:0;right:0;height:100vh;width:300px;max-width:85%;background:rgba(15,35,55,.95);backdrop-filter:blur(22px) saturate(150%);box-shadow:-2px 0 22px -4px rgba(0,0,0,.65),0 0 0 1px rgba(255,255,255,.06);transform:translateX(100%);transition:transform .45s cubic-bezier(.68,-0.25,.25,1);z-index:400;display:flex;flex-direction:column;border-top-left-radius:22px;border-bottom-left-radius:22px;}
.side-menu.open{transform:translateX(0);}
.side-menu-inner{padding:1.4rem 1.2rem 2.2rem;overflow-y:auto;}
.close-menu{background:none;border:none;color:var(--text-muted);font-size:2rem;line-height:1;padding:0 .25rem;margin:-.5rem 0 .5rem auto;display:block;}
.close-menu:hover{color:var(--text);}
.menu-group{margin-bottom:1.6rem;}
.menu-title{font-size:.65rem;letter-spacing:3px;text-transform:uppercase;font-weight:600;color:var(--text-muted);margin:0 0 .75rem;}
.menu-link{display:block;padding:.55rem .75rem;border-radius:10px;font-size:.8rem;color:var(--text-muted);text-decoration:none;transition:background .25s,color .25s;font-weight:500;letter-spacing:.3px;}
.menu-link:hover{background:linear-gradient(135deg,rgba(var(--accent-rgb),.25),rgba(var(--accent-rgb),.05));color:var(--text);}
.menu-backdrop{position:fixed;inset:0;background:linear-gradient(120deg,rgba(5,11,20,.7),rgba(7,17,29,.65));backdrop-filter:blur(4px);opacity:0;visibility:hidden;transition:opacity .4s;z-index:300;}
.menu-backdrop.show{opacity:1;visibility:visible;}
.hidden{display:none !important;}

@media (max-width:720px){
  .header-actions input[type=search]{width:150px;}
  .cf-handle {font-size:clamp(2.4rem,10vw,4.2rem);}
  .app-header {padding:1.4rem 1.1rem .6rem;}
}

/* Mini TOC */
.mini-toc {position:fixed;left:18px;top:50%;transform:translateY(-50%);z-index:120; background:linear-gradient(160deg,rgba(15,30,50,.88),rgba(10,20,35,.82));backdrop-filter:blur(14px);padding:12px 10px 14px;border-radius:18px;border:1px solid rgba(255,255,255,.06);box-shadow:0 10px 28px -8px rgba(0,0,0,.6),0 0 0 1px rgba(255,255,255,.05);width:150px;}
.mini-toc ul{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:4px;}
.mini-toc a{display:block;padding:6px 10px;border-radius:10px;color:var(--text-muted);font-size:.72rem;letter-spacing:.6px;font-weight:600;text-decoration:none;position:relative;transition:background .25s,color .25s;}
.mini-toc a::before{content:"";position:absolute;left:6px;top:50%;transform:translateY(-50%);width:4px;height:4px;border-radius:50%;background:var(--text-muted);opacity:.5;transition:background .3s, transform .3s, opacity .3s;}
.mini-toc a:hover{color:var(--text);background:rgba(var(--accent-rgb),.14);}
.mini-toc a.active{color:var(--text);background:linear-gradient(135deg,rgba(var(--accent-rgb),.35),rgba(var(--accent-rgb),.12));box-shadow:0 0 0 1px rgba(var(--accent-rgb),.3) inset;}
.mini-toc a.active::before{background:var(--accent);transform:translateY(-50%) scale(1.8);opacity:1;}
@media (max-width:1000px){ .mini-toc {display:none;} }

/* High contrast mode */
.app-centered { max-width:1250px; margin:0 auto; }
.app-centered > .app-section { margin-left:auto; margin-right:auto; }
.app-section > h5, .app-section > h4, .app-section > h3 { text-align:center; }
.dashboard-bento { margin-left:auto; margin-right:auto; }
.high-contrast {
  --bg: #04101d;
  --bg-alt: #071a29;
  --bg-soft: #0d2434;
  --text: #ffffff;
  --text-muted: #b9cee2;
  --border: #2c4b63;
  --accent: #61b4ff;
  --accent-rgb: 97,180,255;
  --accent-soft: rgba(var(--accent-rgb), .25);
  --gradient-accent: linear-gradient(135deg,#3294ff,#9a5bff);
}
.high-contrast .card, .high-contrast .accordion-item, .high-contrast .list-group-item { border-color: rgba(255,255,255,.12) !important; }
.high-contrast .mini-toc { background:linear-gradient(160deg,rgba(15,40,60,.95),rgba(10,30,50,.9)); }
